<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
     @font-face {
    font-family: 'Frankfurter';
    src: url('fonts/Frankfurter.ttf') format('truetype');
}
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Frankfurter', 'Fredoka', 'Arial Rounded MT Bold', 'Helvetica Rounded', Arial, sans-serif;
   
      background: #000;
      overflow: hidden;
      position: relative;
      height: 100vh;
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      touch-action: none;
          -webkit-user-select: none; /* Safari */
    -ms-user-select: none;     /* IE 10 and Edge */
    user-select: none;         /* Standard syntax */
    }

    /* Backgrounds */
    body::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      z-index: -1;
      background-image: url('Ui/desktop_background.png');
    }

  

    .container {
      width: 90%;
      max-width: 800px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2vmin;
      position: relative;
    }

    /* Top Left Buttons */
    .top-left {
      position: absolute;
      top: 2vmin;
      left: 2vmin;
      display: flex;
      gap: 1vmin;
      z-index: 10;
    }

    .btn {
      width: min(max(72px, 10vmin), 96px);
      height: min(max(72px, 10vmin), 96px);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background: transparent;
      padding: 0;
      border: none;
      overflow: hidden;
    }

    .btn img {
      width: min(max(56px, 8vmin), 72px);
      height: auto;
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    /* Top Right Close Button */
    .top-right {
      position: absolute;
      top: 2vmin;
      right: 2vmin;
      z-index: 10;
    }

    /* Main Score Panel */
    .score-panel {
      text-align: center;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1vmin;
    }

    .high-score-badge {
  width: min(max(140px, 24vmin), 180px);
  height: auto;
  margin-bottom: 2vmin;
  transform: scale(1.5); /* Makes it 20% larger visually */
  transform-origin: center;
}

    .score-number {
      font-size: min(max(56px, 8vmin), 96px);
      font-weight: 800;
      color: white;
      margin: 0.5vmin 0;
      text-shadow: 0 0 6px rgba(0,0,0,0.6), 0 0 12px rgba(0,255,255,0.4);
    }

    .high-score {
      font-size: min(max(25px, 4vmin), 30px);
      font-weight: 600;
      color: white;
      display: flex;
      flex-direction: row;
      gap: 10px;
      /* margin-top: 10px; */
      text-shadow: 0 0 2px rgba(0,0,0,0.5);
    }

    .resources {
      display: flex;
      gap: 1vmin;
      margin: 1vmin 0;
      flex-wrap: wrap;
      justify-content: center;
      width: 100%;
    }

    .resource {
      position: relative;
      display: inline-block;
    }

    .resource img {
      width: min(max(140px, 22vmin), 180px);
      height: auto;
      max-width: 100%;
    }

    .resource span {
      position: absolute;
      top: 42%;
      left: 70%;
      transform: translate(-50%, -50%);
      font-size: min(max(24px, 5vmin), 40px);
      font-weight: 800;
      color: white;
      text-shadow: 0 0 4px rgba(0,0,0,0.6), 0 0 8px rgba(255,255,255,0.5);
      white-space: nowrap;
    }

    .coin-multiplier {
      font-size: min(max(28px, 5vmin), 44px);
      font-weight: 700;
      color: white;
      margin: 1vmin 0;
      text-shadow: 0 0 4px rgba(0,0,0,0.6), 0 0 8px rgba(255,255,255,0.5);
    }

    .ad-button {
      position: relative;
      display: inline-block;
      background-color: transparent;
      border: none;
    }

    .ad-button img {
      width: min(max(10px, 21vmin), 240px);
      height: auto;
      cursor: pointer;
      margin: 1vmin 0;
    }

    /* Tablet Layout Tweaks */
    @media (min-width: 761px) and (max-width: 1023px) {
      .container {
        padding: 3vmin;
      }

      .top-left {
        top: 3vmin;
        left: 3vmin;
      }

      .top-right {
        top: 3vmin;
        right: 3vmin;
      }

      .high-score-badge {
        width: min(max(180px, 24vmin), 135px);
      }

      .score-number {
        font-size: min(max(64px, 7vmin), 40px);
        margin-top: -10px;
      }

      .resource img {
        width: min(max(150px, 22vmin), 120px);
      }

      .resource span {
        font-size: min(max(26px, 4.5vmin), 36px);
      }

      .ad-button img {
        width: min(max(180px, 24vmin), 120px);
      }
    }

    /* Mobile Landscape / Small Tablet */
    @media (max-width: 760px) {
      .container {
        padding: 2vmin;
      }

      .top-left {
        top: 2vmin;
        left: 2vmin;
      }

      .top-right {
        top: 2vmin;
        right: 2vmin;
      }

      .high-score-badge {
        width: min(max(140px, 24vmin), 180px);
      }

      .score-number {
        font-size: min(max(56px, 7vmin), 72px);
      }

      .resource img {
        width: min(max(120px, 20vmin), 160px);
      }

      .resource span {
        font-size: min(max(24px, 4.5vmin), 32px);
      }

      .ad-button img {
        width: min(max(140px, 22vmin), 200px);
      }

      /* Ensure buttons are large enough on very small phones */
      .btn {
        width: 80px;
        height: 80px;
      }

      .btn img {
        width: 64px;
      }
    }

    /* Ultra-Small Phones (iPhone SE, etc.) */
    @media (max-width: 375px) {
      .container {
        padding: 1vmin;
        transform: scale(1.1);
        transform-origin: center;
      }

      .score-number {
        font-size: min(max(56px, 8vmin), 72px);
      }

      .resource img {
        width: min(max(100px, 18vmin), 140px);
      }

      .resource span {
        font-size: min(max(22px, 4vmin), 30px);
      }

      .ad-button img {
        width: min(max(120px, 20vmin), 180px);
      }

      .btn {
        width: 80px;
        height: 80px;
      }

      .btn img {
        width: 64px;
      }
    }

    /* Even Smaller Screens (if needed) */
    @media (max-width: 320px) {
      .container {
        padding: 1vmin;
        transform: scale(1.2);
        transform-origin: center;
      }

      .score-number {
        font-size: min(max(56px, 9vmin), 64px);
      }
      

      .resource img {
        width: min(max(90px, 16vmin), 120px);
      }

      .resource span {
        font-size: min(max(20px, 3.5vmin), 28px);
      }

      .ad-button img {
        width: min(max(100px, 18vmin), 160px);
      }

      .btn {
        width: 80px;
        height: 80px;
      }

      .btn img {
        width: 64px;
      }
    }
    .btn:active { transform: scale(0.9); }

    /* --- NEW: Prevents users from selecting or dragging images --- */
img {
    -webkit-user-drag: none; /* Prevents dragging on Chrome/Safari */
    user-select: none;       /* Standard property to prevent selection */
    -moz-user-select: none;    /* Firefox */
    -webkit-user-select: none; /* Chrome/Safari */
    -ms-user-select: none;     /* IE/Edge */
}
  </style>

  <!-- Google H5 Games Ad Placement API -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-games-pub-4968145218643279" crossorigin="anonymous"></script>
<script>
    window.adsbygoogle = window.adsbygoogle || [];
    const adBreak = adConfig = function(o) { adsbygoogle.push(o); }
</script>
</head>
<body>

  <!-- Top Left Buttons -->
  <div class="top-left">
    <div class="btn" id="gameOverMusicBtn">
      <img src="Ui/music_button.png" alt="Music">
    </div>
    <div class="btn" id="gameOverSoundBtn">
      <img src="Ui/sound_button.png" alt="Sound">
    </div>
  </div>

  <!-- Top Right Close Button -->
  <div class="top-right">
    <div class="btn">
      <img src="Ui/close_button.png" id="gameOverCloseBtn" alt="Close">
    </div>
  </div>

  <!-- Main Content -->
  <div class="container">
    <div class="score-panel">
      <img src="Ui/game_over.png" class="high-score-badge" alt="High Score Badge">
      <div class="score-number" id="gameOverScoreValue">0</div><div class="high-score">
      <div class="high-score-label">High score:</div>
      <div class="high-score-number" id="gameOverHighScoreValue">0</div>
      </div>
      <div class="resources">
        <div class="resource">
          <img src="Ui/diamond_panel.png" alt="Diamond Panel">
          <span id="gameOverDiamondValue">0</span>
        </div>
        <div class="resource">
          <img src="Ui/coin_panel.png" alt="Coin Panel">
          <span id="gameOverCoinValue" style="left: 77%;">0</span>
        </div>
      </div>
      <div class="coin-multiplier">2x Your Coin</div>
      <button class="ad-button" id="doubleCoinsAdBtn">
        <img src="Ui/ad_button.png" alt="Ad Button">
      </button>
    </div>
  </div>
 <!-- Script to load data and handle buttons -->
    <script>
    // Use a unique sound object for this screen
    const musicSound = new Audio('sounds/music.mp3');


    // Get all the UI elements
    const musicBtn = document.getElementById('gameOverMusicBtn');
    const soundBtn = document.getElementById('gameOverSoundBtn');
    const closeBtn = document.getElementById('gameOverCloseBtn');
    const adBtn = document.getElementById('doubleCoinsAdBtn');

    // --- MUTE LOGIC ---
    let isMusicMuted = localStorage.getItem('isMusicMuted') === 'true';
    let isSfxMuted = localStorage.getItem('isSfxMuted') === 'true';

    function applyMuteStates() {
        musicSound.muted = isMusicMuted;
        // This visual toggle assumes you have a .muted class in your CSS
        // If not, the button will still work, just not change appearance.
        musicBtn.classList.toggle('muted', isMusicMuted);
        soundBtn.classList.toggle('muted', isSfxMuted);
        if (!isMusicMuted && musicSound.paused) {
            musicSound.play().catch(e => {});
        } else if (isMusicMuted) {
            musicSound.pause();
        }
    }
    
    // --- LOAD DATA from localStorage ---
    const sessionScore = parseInt(localStorage.getItem('sessionScore') || '0');
    const sessionCoins = parseInt(localStorage.getItem('sessionCoins') || '0');
    const sessionDiamonds = parseInt(localStorage.getItem('sessionDiamonds') || '0');
    const highScore = parseInt(localStorage.getItem('highScores') || '0');

    // --- POPULATE THE UI ---
    document.getElementById('gameOverScoreValue').textContent = sessionScore;
    document.getElementById('gameOverHighScoreValue').textContent = highScore;
    document.getElementById('gameOverCoinValue').textContent = sessionCoins;
    document.getElementById('gameOverDiamondValue').textContent = sessionDiamonds;

    // --- MUSIC AND SOUND CONTROL ---
    musicSound.loop = true;
    applyMuteStates(); // Set initial state from localStorage

    // --- EVENT LISTENERS ---
    
    // CORRECTED Mute on Minimize
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            musicSound.muted = true;
        } else {
            // Use the correct audio object: musicSound
            musicSound.muted = localStorage.getItem('isMusicMuted') === 'true';
        }
    });
    
    musicBtn.addEventListener('click', () => {
        isMusicMuted = !isMusicMuted;
        localStorage.setItem('isMusicMuted', isMusicMuted);
        applyMuteStates();
    });
    
    soundBtn.addEventListener('click', () => { 
        isSfxMuted = !isSfxMuted;
        localStorage.setItem('isSfxMuted', isSfxMuted);
        applyMuteStates();
    });

    // CORRECTED Close Button functionality
    closeBtn.addEventListener('click', () => {
        // 'replace' must be called as a function with ()
        window.location.replace('index.html');
    });

    // --- NEW, FUNCTIONAL "Double Coins" Ad Logic ---
// --- NEW, FUNCTIONAL "Double Coins" Ad Logic for Google Ads ---
adBtn.addEventListener('click', () => {
    console.log("Requesting Rewarded Ad for Double Coins...");

    // Disable the button immediately to prevent multiple clicks
    adBtn.disabled = true;
    adBtn.innerHTML = 'Loading Ad...'; 

    adBreak({
      type: 'reward',
      name: 'double-coins',
      beforeAd: () => { 
          // Pause music on this screen if it's playing
          if (!isMusicMuted) {
              musicSound.pause();
          }
      },
      adBreakDone: (placementInfo) => {
        console.log("Double coins ad break done. Status:", placementInfo.breakStatus);
        if (placementInfo.breakStatus === 'viewed') {
            console.log("Ad Finished, granting double coins reward.");

            const sessionCoins = parseInt(localStorage.getItem('sessionCoins') || '0');
            let totalSavedCoins = parseInt(localStorage.getItem('savedCoins') || '0');
            // The coins from the session were already added once when the game ended.
            // We just need to add them AGAIN to double them.
            totalSavedCoins += sessionCoins;
            localStorage.setItem('savedCoins', totalSavedCoins);

            const coinValueElement = document.getElementById('gameOverCoinValue') || document.getElementById('highScoreCoinValue');
            coinValueElement.textContent = sessionCoins * 2;
            
            coinValueElement.style.transform = 'scale(1.2)';
            coinValueElement.style.color = '#ffc400';

            // Permanently change the button's state so it can't be used again
            adBtn.innerHTML = 'Coins Doubled!';
        } else {
            console.error("Ad not viewed, reward not granted.");
            // Re-enable the button so the player can try again
            adBtn.disabled = false;
            adBtn.innerHTML = '<img src="Ui/ad_button.png" alt="Ad Button">'; // Restore the image
            // Resume music if ad was skipped
            if (!isMusicMuted) {
                musicSound.play();
            }
        }
      },
    });
});

</script>
<script>
    // --- Your existing script code ---

    // Add this line to disable the right-click menu everywhere
    window.addEventListener('contextmenu', function (e) { 
        e.preventDefault(); 
    }, false);
</script>
</body>
</html>