<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Shop - Space Wars</title>
    <style>
        @font-face {
            font-family: 'Frankfurter';
            src: url('fonts/Frankfurter.ttf') format('truetype');
        }
        * {
            margin: 0; padding: 0; box-sizing: border-box;
        }
        body {
            font-family: 'Frankfurter', sans-serif;
            background: url('Ui/desktop_background.png') no-repeat center center fixed;
            background-size: cover;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
                -webkit-user-select: none; /* Safari */
    -ms-user-select: none;     /* IE 10 and Edge */
    user-select: none;         /* Standard syntax */
        }

        /* ================= SCALABLE CONTAINER (THE CORE FIX) ================= */
        .container {
            width: 850px; 
            height: 500px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transform-origin: center center;
            transition: transform 0.1s ease-out;
        }

        /* ================= TOP BAR STYLES ================= */
        .top-bar {
            position: absolute;
            top: 15px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            z-index: 10;
        }
        .top-controls { display: flex; gap: 10px; }
        .top-currency { display: flex; gap: 10px;  width: 260px; height: 60px;}
        .ui-button {
            width: 55px; height: 55px;
            background-size: contain; background-repeat: no-repeat; background-position: center;
            border: none; background-color: transparent; cursor: pointer;
            /* transition: transform 0.1s ease; */
        }
        .ui-button:active { transform: scale(0.9); }
        .stat-panel {
            width: 160px; height: 50px; background-size: 100% 100%;
            display: flex; justify-content: flex-end; align-items: center;
            padding-right: 25px; font-size: 24px; font-weight: bold; color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
        }
        #diamond-panel { background-image: url('Ui/diamond_panel.png'); }
        #coin-panel { background-image: url('Ui/coin_panel.png'); }

        /* ================= MAIN SHOP PANEL STYLES ================= */
        .shop-container {
            position: relative;
            width: 550px;
            height: 480px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .panel {
            position: absolute;
            width: 70%; height: 70%;
            background-size: 100% 100%;
            display: none;
            color: white;
        }
        .panel.active { display: block; }
        #panel1 { background-image: url('Ui/yellow_panel_powerups.png')}
        #panel2 { background-image: url('Ui/yellow_panel_rockets.png'); }
        /* #panel3 { background-image: url('Ui/yellow_panel_shop.png'); } */
        
        #close-btn {
            background-image: url('Ui/close_button.png');
            position: absolute;
            top: 15%; right: 22%; width: 60px; height: 60px;
            z-index: 10;
        }
        .nav-btn {
            position: absolute; top: 45%; 
            width: 60px; height: 60px;
            z-index: 10;
        }
        #prevBtn {  left:85px; background-image: url('Ui/left_navigate.png'); }
        #nextBtn { right:85px; background-image: url('Ui/right_navigate.png'); }

        .button-overlay {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 5;
        }
        
        .overlay-btn {
            position: absolute;
            background-size: 100% 100%;
            border: none;
            background-color: transparent;
            cursor: pointer;
            color: white;
            font-family: 'Frankfurter', sans-serif; /* THIS IS THE FONT FIX */
            font-size: 15px;
        }
        
        /* --- Positioning for Buttons on Panel 1 (Powerups - List Layout) --- */
        #panel1-btn-1 { top: 33.5%; right: 3%; width: 15%; height: 13%; background-image: url('Ui/buy_button.png');  }
        #panel1-btn-2 { top: 52.5%; right: 3%; width: 15%; height: 13%; background-image: url('Ui/buy_button.png'); }
        #panel1-btn-3 { top: 72.5%; right: 3%; width: 15%; height: 13%; background-image: url('Ui/buy_button.png'); }
        #panel1-btn-4 { top: 93.5%; right: 3%; width: 15%; height: 13%; background-image: url('Ui/buy_button.png'); }
        
        /* --- NEW: Power-up Info and Progress Bar Styles --- */
        .powerup-row {
            position: absolute;
            left: 13.5%; 
            width: 40%; 
            height: 13%;
            display: flex;
            align-items: center;
        }
        .powerup-row[data-powerup="bolt"] { top: 16.5%; }
        .powerup-row[data-powerup="speed"] { top: 36.5%; }
        .powerup-row[data-powerup="magnet"] { top: 56.5%; }
        .powerup-row[data-powerup="shield"] { top: 76.5%; }
        
        .cost-display {
            color: white;
            font-size: 18px;
            margin-left: 25%; 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .progress-bar-container {
            width: 45%; 
            height: 18px;
            background-color: #bcc9ff; 
            border-radius: 9px;
            margin-left: auto; 
            margin-right: 5%;
            overflow: hidden;
            border: 3px solid #5650ce;
            padding: 2px;
        }

        .progress-bar {
            width: 0%; 
            height: 100%;
            background-color: #ffc400; 
            border-radius: 7px;
            transition: width 0.3s ease-in-out;
        }

        /* --- Positioning for Buttons on Panel 2 & 3 --- */
        #panel2-btn-1 { top: 58%; left: 44%; width: 24%; height: 11%; background-image: url('Ui/select_button.png'); }
        #panel2-btn-2 { top: 94.5%; left: 44%; width: 24%; height: 11%; background-image: url('Ui/coin_panel.png'); color: white; padding-left: 8px;}
        #panel2-btn-3 { top: 58%; left: 74.5%; width: 24%; height: 11%; background-image: url('Ui/coin_panel.png'); color: white; padding-left: 8px;}
        #panel2-btn-4 { top: 94.5%; left: 74.5%; width: 24%; height: 11%; background-image: url('Ui/coin_panel.png'); color: white; padding-left: 8px;}
        /* #panel3-btn-1 { top: 58%; left: 44%; width: 24%; height: 11%; background-image: url('Ui/select_button.png'); }
        #panel3-btn-2 { top: 94.5%; left: 44%; width: 24%; height: 11%; background-image: url('Ui/diamond_panel.png'); color: white;}
        #panel3-btn-3 { top: 58%; left: 74.5%; width: 24%; height: 11%; background-image: url('Ui/diamond_panel.png'); color: white;}
        #panel3-btn-4 { top: 94.5%; left: 74.5%; width: 24%; height: 11%; background-image: url('Ui/diamond_panel.png'); color: white;}
         */
      /* ================= RESPONSIVE STYLES (PORTRAIT PHONE) ================= */
        @media (orientation: portrait) {
            body {
                background-image: url('Ui/mobile_background.png'); width: 100%;
            }
            .container {
                width: 50%;
                height: 50%;
                justify-content: flex-start;
                padding-top: 2vh;
            }
            .top-bar {
                position: relative; order: 1; width: 100%;
                justify-content: center; margin-bottom: 2vh; top: -36%;
            }
            .top-controls { display: none; }
            .stat-panel { width: 500vw; height: 14vw; font-size: 5vw; padding-right: 5vw; }
            .shop-container { order: 2; width: 90vw; }
            .overlay-btn { font-family: Frankfurter, sans-serif; font-size: 25px; }
            #close-btn { top: -42%; right: 4%; width: 25%; height: 25%; z-index: 10; }
            .nav-btn { top: auto; bottom: -50%; width: 18%; height: 18%; z-index: 10; }
            #prevBtn { left: 25%; }
            #nextBtn { right: 25%; }
            .panel {
                position: absolute; width: 180%; height: 180%;
                background-size: 100% 100%; display: none;
                font-family: 'Frankfurter', sans-serif; font-size: 55px;
            }
            #panel1-btn-1 { top: -10%; right: 45%; width: 16%; height: 13%; background-image: url('Ui/buy_button.png'); }
            #panel1-btn-2 { top: 10%; right: 45%; width: 16%; height: 13%; background-image: url('Ui/buy_button.png'); }
            #panel1-btn-3 { top: 30%; right: 45%; width: 16%; height: 13%; background-image: url('Ui/buy_button.png'); }
            #panel1-btn-4 { top: 50%; right: 45%; width: 16%; height: 13%; background-image: url('Ui/buy_button.png'); }
            #panel2-btn-1 { top: 14%; left: 0.8%; width: 24%; height: 11%; background-image: url('Ui/select_button.png'); }
            #panel2-btn-2 { top: 51%; left: 0.8%; width: 24%; height: 11%; background-image: url('Ui/coin_panel.png'); }
            #panel2-btn-3 { top: 14%; left: 31%; width: 24%; height: 11%; background-image: url('Ui/coin_panel.png'); }
            #panel2-btn-4 { top: 51%; left: 31%; width: 24%; height: 11%; background-image: url('Ui/coin_panel.png'); }
            /* #panel3-btn-1 { top: 14%; left: 0.8%; width: 24%; height: 11%; background-image: url('Ui/select_button.png'); }
            #panel3-btn-2 { top: 51%; left: 0.8%; width: 24%; height: 11%; background-image: url('Ui/diamond_panel.png'); }
            #panel3-btn-3 { top: 14%; left: 31%; width: 24%; height: 11%; background-image: url('Ui/diamond_panel.png'); }
            #panel3-btn-4 { top: 51%; left: 31%; width: 24%; height: 11%; background-image: url('Ui/diamond_panel.png'); }
             */
           
            /* --- MODIFIED: Show and style progress bars for mobile --- */
.powerup-row {
    display: flex; /* This makes them visible */
    position: absolute;
    left: 27%; 
    width: 25%; 
    height: 13%;
    align-items: center;
}
.powerup-row[data-powerup="bolt"] { top: 15%; }
.powerup-row[data-powerup="speed"] { top: 35%; }
.powerup-row[data-powerup="magnet"] { top: 55%; }
.powerup-row[data-powerup="shield"] { top: 75%; }

.cost-display {
    font-size: 4vw;
    margin-left: 20%;
}
.progress-bar-container {
    width: 60%;
    height: 12px;
    border-width: 1px;
    padding: 1px;
}
        }
        
        /* ================= RESPONSIVE STYLES FOR PORTRAIT TABLETS ================= */
        @media (min-width: 600px) and (orientation: portrait) {
            body { background-image: url('Ui/mobile_background.png'); }
            .container { width: 80%; height: 65%; justify-content: center; padding-top: 0; }
            .top-bar { position: absolute; top: -12%; width: 100%; justify-content: space-between; margin-bottom: 0; }
            .top-controls { display: flex; }
            .stat-panel { width: 25vw; max-width: 180px; height: 9vw; max-height: 65px; font-size: 3.5vw; padding-right: 15px; }
            .shop-container { width: 90%; max-width: 500px; }
            .panel { width: 100%; height: 100%; }
            #close-btn { top: 2%; right: 5%; width: 16%; height: 16%; }
            .nav-btn { top: 50%; bottom: auto; width: 15%; height: 15%; }
            #prevBtn { left: -5%; }
            #nextBtn { right: -5%; }
            .overlay-btn { font-size: clamp(14px, 2.5vw, 18px); }
            
            /* Reposition power-up rows for tablets */
            .powerup-row { width: 26%; left: 26%; }
            .powerup-row[data-powerup="bolt"] { top: 15.5%;}
            .powerup-row[data-powerup="speed"] { top: 35.5%; }
            .powerup-row[data-powerup="magnet"] { top: 55.5%; }
            .powerup-row[data-powerup="shield"] { top: 75.5%; }

            /* Reposition buttons for tablets */
            #panel1-btn-1 { top: 13.5%; right: 22%; width: 15%; height: 13%; }
            #panel1-btn-2 { top: 33.5%; right: 22%; width: 15%; height: 13%; }
            #panel1-btn-3 { top: 53.5%; right: 22%; width: 15%; height: 13%; }
            #panel1-btn-4 { top: 73.5%; right: 22%; width: 15%; height: 13%; }

            #panel2-btn-1 { top: 35%; left: 23%; width: 24%; height: 11%; }
            #panel2-btn-2 { top: 72.5%; left: 23%; width: 24%; height: 11%; }
            #panel2-btn-3 { top: 35%; left: 53.5%; width: 24%; height: 11%; }
            #panel2-btn-4 { top: 72.5%; left: 53.5%; width: 24%; height: 11%; }

/* 
            #panel3-btn-1 { top: 34%; left: 23%; width: 24%; height: 11%; }
            #panel3-btn-2 { top: 71.5%; left: 23%; width: 24%; height: 11%; }
            #panel3-btn-3 { top: 34%; left: 53.5%; width: 24%; height: 11%; }
            #panel3-btn-4 { top: 71.5%; left: 53.5%; width: 24%; height: 11%; } */
        }

        /* --- NEW: Shake Animation for Errors --- */
    .shake-error {
        animation: shake 0.5s ease-in-out;
    }

    @keyframes shake {    
    0%, 100% { transform: translateX(0); }
    10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
    20%, 40%, 60%, 80% { transform: translateX(8px); }
    }    
    /* --- NEW: Prevents users from selecting or dragging images --- */
img {
    -webkit-user-drag: none; /* Prevents dragging on Chrome/Safari */
    user-select: none;       /* Standard property to prevent selection */
    -moz-user-select: none;    /* Firefox */
    -webkit-user-select: none; /* Chrome/Safari */
    -ms-user-select: none;     /* IE/Edge */
}


    </style>

    <!-- Google H5 Games Ad Placement API -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-games-pub-4968145218643279" crossorigin="anonymous"></script>
<script>
    window.adsbygoogle = window.adsbygoogle || [];
    const adBreak = adConfig = function(o) { adsbygoogle.push(o); }
</script>

</head>
<body>
    <div class="container">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="top-controls">
                <button class="ui-button" id="musicBtn" style="background-image: url('Ui/music_button.png');"></button>
                <button class="ui-button" id="soundBtn" style="background-image: url('Ui/sound_button.png');"></button>
            </div>
            <div class="top-currency">
                <div class="stat-panel" id="diamond-panel">
                    <label id="diamondCountLabel">0</label>
                </div>
                <div class="stat-panel" id="coin-panel">
                    <label id="coinCountLabel">0</label>
                </div>
            </div>
        </div>

        <!-- Main Shop Panel -->
        <div class="shop-container">
            <!-- Background Panels -->
            <div class="panel active" id="panel1">
                <!-- NEW: Add the info rows for Panel 1 -->
                <div class="powerup-row" data-powerup="bolt">
                    <span class="cost-display"></span>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="bolt-progress"></div>
                    </div>
                </div>
                <div class="powerup-row" data-powerup="speed">
                     <span class="cost-display"></span>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="speed-progress"></div>
                    </div>
                </div>
                <div class="powerup-row" data-powerup="magnet">
                     <span class="cost-display"></span>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="magnet-progress"></div>
                    </div>
                </div>
                <div class="powerup-row" data-powerup="shield">
                     <span class="cost-display"></span>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="shield-progress"></div>
                    </div>
                </div>
            </div>
            <div class="panel" id="panel2"></div>
            <!-- <div class="panel" id="panel3"></div> -->

            <!-- Interactive Buttons Overlay -->
            <div class="button-overlay">
                <div class="panel active" id="panel1-buttons">
                    <button class="overlay-btn" id="panel1-btn-1" data-powerup="bolt"></button>
                    <button class="overlay-btn" id="panel1-btn-2" data-powerup="speed"></button>
                    <button class="overlay-btn" id="panel1-btn-3" data-powerup="magnet"></button>
                    <button class="overlay-btn" id="panel1-btn-4" data-powerup="shield"></button>
                </div>
                <div class="panel" id="panel2-buttons">
                    <button class="overlay-btn" id="panel2-btn-1" data-plane="plane-c"></button>
                    <button class="overlay-btn" id="panel2-btn-2" data-plane="plane-c2">5000</button>
                    <button class="overlay-btn" id="panel2-btn-3" data-plane="plane-c1">2500</button>
                    <button class="overlay-btn" id="panel2-btn-4" data-plane="plane-c3">8000</button>
                </div>
                <!-- <div class="panel" id="panel3-buttons">
                    <button class="overlay-btn" id="panel3-btn-1"></button>
                    <button class="overlay-btn" id="panel3-btn-2">50</button>
                    <button class="overlay-btn" id="panel3-btn-3">20</button>
                    <button class="overlay-btn" id="panel3-btn-4">80</button>
                </div> -->
            </div>

            <!-- Navigation and Close Buttons -->
            <button class="ui-button" id="close-btn"></button>
            <button class="ui-button nav-btn" id="prevBtn"></button>
            <button class="ui-button nav-btn" id="nextBtn"></button>
        </div>
    </div>

    <script>
    // --- UI ELEMENTS ---
    const coinCountLabel = document.getElementById('coinCountLabel');
    const diamondCountLabel = document.getElementById('diamondCountLabel');

     const musicBtn = document.getElementById('musicBtn');
    const soundBtn = document.getElementById('soundBtn');

    // --- NEW: Centralized Mute Logic ---
    let isMusicMuted = localStorage.getItem('isMusicMuted') === 'true';
    let isSfxMuted = localStorage.getItem('isSfxMuted') === 'true';

    // This shop page doesn't have its own music, it just sets the global state.
    function applyMuteStates() {
        musicBtn.classList.toggle('muted', isMusicMuted);
        soundBtn.classList.toggle('muted', isSfxMuted);
    }

    // Attach listeners to the buttons
    musicBtn.addEventListener('click', () => {
        isMusicMuted = !isMusicMuted;
        localStorage.setItem('isMusicMuted', isMusicMuted);
        applyMuteStates();
    });

    soundBtn.addEventListener('click', () => {
        isSfxMuted = !isSfxMuted;
        localStorage.setItem('isSfxMuted', isSfxMuted);
        applyMuteStates();
    });

    const panels = [
        { bg: document.getElementById('panel1'), buttons: document.getElementById('panel1-buttons') },
        { bg: document.getElementById('panel2'), buttons: document.getElementById('panel2-buttons') },
        // { bg: document.getElementById('panel3'), buttons: document.getElementById('panel3-buttons') }
    ];
    let currentPanelIndex = 0;

    // --- POWER-UP CONFIGURATION ---
    const POWERUP_CONFIG = {
        bolt: { cost: 500, baseTime: 10, increment: 6, maxLevel: 4, progressBar: document.getElementById('bolt-progress') },
        speed: { cost: 500, baseTime: 6, increment: 6, maxLevel: 4, progressBar: document.getElementById('speed-progress') },
        magnet: { cost: 500, baseTime: 8, increment: 6, maxLevel: 4, progressBar: document.getElementById('magnet-progress') },
        shield: { cost: 500, baseTime: 10, increment: 6, maxLevel: 4, progressBar: document.getElementById('shield-progress') }
    };

    // --- ROCKET CONFIGURATION ---
    const ROCKET_CONFIG = {
        'plane-c':  { cost: 0,    button: document.getElementById('panel2-btn-1') },
        'plane-c1': { cost: 2500, button: document.getElementById('panel2-btn-3') },
        'plane-c2': { cost: 5000, button: document.getElementById('panel2-btn-2') },
        'plane-c3': { cost: 8000, button: document.getElementById('panel2-btn-4') }
    };

    // ========================================================
    // --- FUNCTIONS (Correctly Structured) ---
    // ========================================================

    function updateCoinDisplay() {
        coinCountLabel.textContent = localStorage.getItem('savedCoins') || '0';
    }

    // --- Power-Up Functions ---
    function updateProgressBar(powerupName) {
        const config = POWERUP_CONFIG[powerupName];
        const savedTime = parseInt(localStorage.getItem(`${powerupName}Time`) || config.baseTime);
        const purchaseCount = Math.max(0, Math.floor((savedTime - config.baseTime) / config.increment));
        const progressPercentage = Math.min(100, (purchaseCount / config.maxLevel) * 100);
        config.progressBar.style.width = `${progressPercentage}%`;
    }

    function buyPowerup(powerupName, buttonElement) {
    const config = POWERUP_CONFIG[powerupName];
    let savedCoins = parseInt(localStorage.getItem('savedCoins') || '0');
    
    if (savedCoins >= config.cost) {
        const currentLevel = Math.max(0, Math.floor((parseInt(localStorage.getItem(`${powerupName}Time`) || config.baseTime) - config.baseTime) / config.increment));
        if (currentLevel >= config.maxLevel) {
            // This alert is for a maxed-out item, which is fine to keep.
            buttonElement.classList.add('shake-error');
            return;
        }

        savedCoins -= config.cost;
        localStorage.setItem('savedCoins', savedCoins);
        updateCoinDisplay();
        
        let currentPowerupTime = parseInt(localStorage.getItem(`${powerupName}Time`) || config.baseTime);
        currentPowerupTime += config.increment;
        localStorage.setItem(`${powerupName}Time`, currentPowerupTime);
        
        updateProgressBar(powerupName);
    } else {
        // --- THIS IS THE CHANGE: Shake the button instead of showing an alert ---
        buttonElement.classList.add('shake-error');
        setTimeout(() => {
            buttonElement.classList.remove('shake-error');
        }, 500);
    }
}

    // --- Rocket Functions ---
    function updateRocketButtonsUI() {
    // 1. Get the last selected plane from storage. Default to 'plane-c' if none is found.
    const selectedPlane = localStorage.getItem('selectedPlane') || 'plane-c';

    // 2. Loop through every rocket defined in the config
    for (const planeName in ROCKET_CONFIG) {
        const config = ROCKET_CONFIG[planeName];
        const isUnlocked = (planeName === 'plane-c') || (localStorage.getItem(`unlocked_${planeName}`) === 'true');

        if (isUnlocked) {
            config.button.textContent = ''; // Make sure cost text is hidden

            // 3. THIS IS THE CRITICAL PART:
            // If the current plane in the loop is the one saved as 'selectedPlane'...
            if (planeName === selectedPlane) {
                // ...then set its background image to selected_button.png
                config.button.style.backgroundImage = "url('Ui/selected.png')";
            } else {
                // ...otherwise, set its image to the normal select_button.png
                config.button.style.backgroundImage = "url('Ui/select_button.png')";
            }
        } else {
            // If the plane is locked, show the coin panel and its cost
            config.button.style.backgroundImage = "url('Ui/coin_panel.png')";
            config.button.textContent = config.cost;
        }
    }
}

    function handleRocketClick(planeName, buttonElement) {
    const config = ROCKET_CONFIG[planeName];
    const isUnlocked = (planeName === 'plane-c') || (localStorage.getItem(`unlocked_${planeName}`) === 'true');

    if (isUnlocked) {
        // Action: Select Plane
        localStorage.setItem('selectedPlane', planeName);
        updateRocketButtonsUI();
    } else {
        // Action: Buy Plane
        let savedCoins = parseInt(localStorage.getItem('savedCoins') || '0');
        if (savedCoins >= config.cost) {
            savedCoins -= config.cost;
            localStorage.setItem('savedCoins', savedCoins);
            localStorage.setItem(`unlocked_${planeName}`, 'true');
            localStorage.setItem('selectedPlane', planeName);
            updateCoinDisplay();
            updateRocketButtonsUI();
        } else {
            // --- THIS IS THE CHANGE: Shake the button instead of showing an alert ---
            buttonElement.classList.add('shake-error');
            setTimeout(() => {
                buttonElement.classList.remove('shake-error');
            }, 500);
        }
    }
}
    

    // --- General UI Functions ---
    function showPanel(index) {
        panels.forEach((p, i) => {
            p.bg.classList.toggle('active', i === index);
            if (p.buttons) { p.buttons.classList.toggle('active', i === index); }
        });
        currentPanelIndex = index;
    }

    function resizeUI() {
        const container = document.querySelector('.container');
        const isPortrait = window.innerHeight > window.innerWidth;

        if (isPortrait) {
            container.style.transform = 'none';
        } else {
            const designWidth = 850;
            const designHeight = 500;
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            const scaleX = windowWidth / designWidth;
            const scaleY = windowHeight / designHeight;
            const scale = Math.min(scaleX, scaleY);
            container.style.transform = `scale(${scale})`;
        }
    }


    // ========================================================
    // --- EVENT LISTENERS ---
    // ========================================================

    window.addEventListener('load', () => {
        updateCoinDisplay();
        diamondCountLabel.textContent = localStorage.getItem('savedDiamonds') || '0';
        Object.keys(POWERUP_CONFIG).forEach(updateProgressBar);
        updateRocketButtonsUI();
        resizeUI();
        applyMuteStates();
    });

    window.addEventListener('resize', resizeUI);

    document.getElementById('prevBtn').addEventListener('click', () => {
        currentPanelIndex = (currentPanelIndex - 1 + panels.length) % panels.length;
        showPanel(currentPanelIndex);
    });

    document.getElementById('nextBtn').addEventListener('click', () => {
        currentPanelIndex = (currentPanelIndex + 1) % panels.length;
        showPanel(currentPanelIndex);
    });

    document.getElementById('close-btn').addEventListener('click', () => {
        // 'replace' must be called as a function with ()
        window.location.replace('index.html');
    });

    // Attach click listener for all Panel 1 buy buttons
document.querySelectorAll('#panel1-buttons .overlay-btn').forEach(button => {
    button.addEventListener('click', () => {
        // Pass the button itself to the function
        buyPowerup(button.dataset.powerup, button);
    });
});

// Attach click listeners for all Panel 2 rocket buttons
document.querySelectorAll('#panel2-buttons .overlay-btn').forEach(button => {
    button.addEventListener('click', () => {
        // Pass the button itself to the function
        handleRocketClick(button.dataset.plane, button);
    });
});
</script>
<script>
    // --- Your existing script code ---

    // Add this line to disable the right-click menu everywhere
    window.addEventListener('contextmenu', function (e) { 
        e.preventDefault(); 
    }, false);
</script>
    
</body>
</html>
